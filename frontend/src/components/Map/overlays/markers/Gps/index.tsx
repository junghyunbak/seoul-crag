import { useContext, useEffect, useRef } from 'react';

import { mapContext } from '@/components/Map/index.context';

import { useMap } from '@/hooks';

import { Box } from '@mui/material';

export function Gps() {
  const { map } = useContext(mapContext);
  const { boundary, gpsLatLng } = useMap();

  const markerRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    if (!map || gpsLatLng.lat === -1 || gpsLatLng.lng === -1 || !markerRef.current) {
      return;
    }

    const marker = new naver.maps.Marker({
      map,
      position: new naver.maps.LatLng(gpsLatLng.lat, gpsLatLng.lng),
      icon: {
        content: markerRef.current,
      },
    });

    return function cleanup() {
      marker.setMap(null);
    };
  }, [map, gpsLatLng, boundary]);

  return (
    <Box
      ref={markerRef}
      sx={{
        position: 'absolute',
        transform: 'translate(-50%, -100%)',
        display: 'flex',
      }}
    >
      <svg width="40" viewBox="0 0 73 102" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M33.4634 30.5211C33.7967 26.6877 33.9634 19.7211 31.9634 22.5211C30.7368 22.8544 28.8196 23.9211 30.9634 25.5211L29.9634 31.0211L30.9634 37.5211L31.4634 42.5211L33.4634 44.0925L40.4634 39.0211L42.4634 42.0211C44.0634 40.8211 41.13 37.612 39.4634 36.1574L35.4634 38.5211L34.9634 29.5568L33.4634 30.5211Z"
          fill="black"
        />
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M24.9634 44.5211L24.83 42.5211C24.7078 42.6877 24.5634 43.5211 24.9634 45.5211C25.3634 47.5211 25.13 45.6877 24.9634 44.5211Z"
          fill="black"
        />
        <path
          d="M59.9634 38.0211C59.9634 31.4378 56.5717 18.9805 43.9634 14.8313L42.8093 18.5211L46.4634 32.0211L49.9634 41.0211L48.9634 48.5211L47.7366 57.0211C53.7009 54.1221 59.359 48.5984 59.9634 38.0211Z"
          fill="#152123"
        />
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M7.96324 56.521L36.4632 99.521L64.9632 56.521C69.1299 49.521 74.9632 31.821 64.9632 17.021C52.4632 -1.47896 22.4632 -4.47896 7.96324 17.021C3.46324 22.8544 -2.83676 38.921 7.96324 56.521ZM12.9634 38.0211C13.517 18.0211 29.194 13.3544 36.9634 13.5211C39.5637 13.6906 41.8883 14.1485 43.9634 14.8313C56.5717 18.9805 59.9634 31.4378 59.9634 38.0211C59.359 48.5984 53.7009 54.1221 47.7366 57.0211C45.6129 58.0533 43.4504 58.7527 41.4634 59.2291C39.7981 59.6283 38.256 59.8708 36.9634 60.0211C18.1634 58.8211 13.13 44.8544 12.9634 38.0211Z"
          fill="#F0A03D"
        />
        <path
          d="M36.9634 13.5211C29.194 13.3544 13.517 18.0211 12.9634 38.0211C13.13 44.8544 18.1634 58.8211 36.9634 60.0211C38.256 59.8708 39.7981 59.6283 41.4634 59.2291L38.4634 48.0211L33.4634 44.0925L31.4634 42.5211L30.9634 37.5211L29.9634 31.0211L24.4634 37.0211L24.83 42.5211L24.9634 44.5211C25.13 45.6877 25.3634 47.5211 24.9634 45.5211C24.5634 43.5211 24.7078 42.6877 24.83 42.5211L24.4634 37.0211L29.9634 31.0211L30.9634 25.5211C28.8196 23.9211 30.7368 22.8544 31.9634 22.5211C33.9634 19.7211 33.7967 26.6877 33.4634 30.5211L34.9634 29.5568L40.4634 26.0211L42.8093 18.5211L43.9634 14.8313C41.8883 14.1485 39.5637 13.6906 36.9634 13.5211Z"
          fill="#FBF4EB"
        />
        <path
          d="M38.4634 48.0211L41.4634 59.2291C43.4504 58.7527 45.6129 58.0533 47.7366 57.0211L48.9634 48.5211L45.4634 49.0211L44.4634 45.0211L42.4634 42.0211L40.4634 39.0211L33.4634 44.0925L38.4634 48.0211Z"
          fill="#FBF4EB"
        />
        <path
          d="M44.4634 45.0211L45.4634 49.0211L48.9634 48.5211L49.9634 41.0211L46.4634 32.0211L39.4634 36.1574C41.13 37.612 44.0634 40.8211 42.4634 42.0211L44.4634 45.0211Z"
          fill="#FBF4EB"
        />
        <path
          d="M40.4634 26.0211L34.9634 29.5568L35.4634 38.5211L39.4634 36.1574L46.4634 32.0211L42.8093 18.5211L40.4634 26.0211Z"
          fill="#FBF4EB"
        />
        <path
          d="M43.9634 14.8313C56.5717 18.9805 59.9634 31.4378 59.9634 38.0211C59.359 48.5984 53.7009 54.1221 47.7366 57.0211M43.9634 14.8313C41.8883 14.1485 39.5637 13.6906 36.9634 13.5211C29.194 13.3544 13.517 18.0211 12.9634 38.0211C13.13 44.8544 18.1634 58.8211 36.9634 60.0211C38.256 59.8708 39.7981 59.6283 41.4634 59.2291M43.9634 14.8313L42.8093 18.5211M29.9634 31.0211L30.9634 25.5211C28.8196 23.9211 30.7368 22.8544 31.9634 22.5211C33.9634 19.7211 33.7967 26.6877 33.4634 30.5211L34.9634 29.5568M29.9634 31.0211L24.4634 37.0211L24.83 42.5211M29.9634 31.0211L30.9634 37.5211L31.4634 42.5211L33.4634 44.0925M41.4634 59.2291L38.4634 48.0211L33.4634 44.0925M41.4634 59.2291C43.4504 58.7527 45.6129 58.0533 47.7366 57.0211M33.4634 44.0925L40.4634 39.0211L42.4634 42.0211M48.9634 48.5211L45.4634 49.0211L44.4634 45.0211L42.4634 42.0211M48.9634 48.5211L47.7366 57.0211M48.9634 48.5211L49.9634 41.0211L46.4634 32.0211M46.4634 32.0211L42.8093 18.5211M46.4634 32.0211L39.4634 36.1574M34.9634 29.5568L40.4634 26.0211L42.8093 18.5211M34.9634 29.5568L35.4634 38.5211L39.4634 36.1574M24.83 42.5211L24.9634 44.5211C25.13 45.6877 25.3634 47.5211 24.9634 45.5211C24.5634 43.5211 24.7078 42.6877 24.83 42.5211ZM39.4634 36.1574C41.13 37.612 44.0634 40.8211 42.4634 42.0211M7.96324 56.521L36.4632 99.521L64.9632 56.521C69.1299 49.521 74.9632 31.821 64.9632 17.021C52.4632 -1.47896 22.4632 -4.47896 7.96324 17.021C3.46324 22.8544 -2.83676 38.921 7.96324 56.521Z"
          stroke="black"
          strokeWidth="4"
          strokeLinejoin="round"
        />
      </svg>
    </Box>
  );
}
